library (lattice)
library (HMM)


text = readChar("my_own_text_file.txt",nchars=10000, useBytes = TRUE)
data <- unlist(strsplit(tolower(gsub("[^a-zA-Z]", "_", text)), ""))

pi=c(0.4,0.6)

P=t(matrix(c(c(0.6177499,0.3822501),c(0.8826096,0.1173904)),nrow=2,ncol=2))

M=t(matrix(c(c(0.037192964,0.009902360,0.032833978,0.044882670,0.057331132,
0.052143890,0.013665015,0.036187536,0.072293323,0.044793972,0.060008388,
0.004256270,0.024770706,0.053520546,0.014232306,0.046981769,0.053733382,
0.066355203,0.046817817,0.006912535,0.016201697,0.013425499,0.024694447,
0.064902148,0.046170421,0.033586536,0.022203489),
c(0.0389931197,0.0697183142,0.0239154174,0.0512772632,0.0404732634,0.0059687348,
0.0211687193,0.0625229746,0.0039632091,0.0567828864,0.0468108656,0.0168355418,
0.0627882213,0.0286478204,0.0389215263,0.0064318198,0.0001698078,0.0493758725,
0.0652709152,0.0069580806,0.0093043072,0.0028807932,0.0521827110,0.0608822385,
0.0645417465,0.0555249876,0.0576888424)),nrow=27,ncol=2))

model <- initHMM(c("0", "1"), c("_", letters), pi, P, M)


system.time(estimate <- baumWelch(model, data, 100)) # 100 iterations

xyplot(estimate$hmm$emissionProbs[1,] ~ c(1:27), scales=list(x=list(at=1:27,
labels=c("_", letters))),type="h", lwd=5, xlab="", ylab="")

xyplot(estimate$hmm$emissionProbs[2,] ~ c(1:27), scales=list(x=list(at=1:27,
labels=c("_", letters))),type="h", lwd=5, xlab="", ylab="")


